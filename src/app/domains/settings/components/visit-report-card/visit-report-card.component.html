<article class="visit-report-card" (click)="!hideActions?onCardClick():''" role="button" tabindex="0"
  [attr.aria-label]="(item.doctor?.full_name ? item.doctor?.full_name : 'Unknown Doctor') + ' appointment card'">

  <div class="visit-report-card__details" [ngClass]="{'visit-report-card__details--fire': type === cardTypes.FIRE}">

    <figure class="visit-report-card__thumbnail">
      <img class="visit-report-card__thumbnail-image" [src]="item.doctor?.image" width="24" height="24" loading="lazy"
        [alt]="item.doctor?.full_name ? item.doctor?.full_name + ' profile picture' : 'Doctor profile picture'"
        (error)="onImageError($event, item.doctor?.gender ?? null)" />
    </figure>

    <div class="visit-report-card__content">
      <div class="visit-report-card__content-header">
        <div class="visit-report-card__content-row">
          <h3 class="visit-report-card__title">
            {{ item.doctor?.full_name }}
          </h3>
          <div class="visit-report-card__data-time-status">
            @if (type === cardTypes.FIRE) {
            @if (isToday) {
            <div [id]="'today-' + (item.id)" class="visit-report-card__info-item" aria-label="Today's appointment">
              <span class="visit-report-card__info-icon" aria-hidden="true" role="img">
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14" fill="none"
                  focusable="false">
                  <path
                    d="M4.66667 3.35449C4.42751 3.35449 4.22917 3.15616 4.22917 2.91699V1.16699C4.22917 0.927826 4.42751 0.729492 4.66667 0.729492C4.90584 0.729492 5.10417 0.927826 5.10417 1.16699V2.91699C5.10417 3.15616 4.90584 3.35449 4.66667 3.35449Z"
                    fill="#47586E" />
                  <path
                    d="M9.33333 3.35449C9.09416 3.35449 8.89583 3.15616 8.89583 2.91699V1.16699C8.89583 0.927826 9.09416 0.729492 9.33333 0.729492C9.57249 0.729492 9.77083 0.927826 9.77083 1.16699V2.91699C9.77083 3.15616 9.57249 3.35449 9.33333 3.35449Z"
                    fill="#47586E" />
                  <path
                    d="M4.95833 8.45835C4.8825 8.45835 4.80667 8.44086 4.73667 8.41169C4.66083 8.38253 4.6025 8.34168 4.54417 8.28918C4.43917 8.17835 4.375 8.03252 4.375 7.87502C4.375 7.79919 4.3925 7.72335 4.42167 7.65335C4.45083 7.58335 4.49167 7.51919 4.54417 7.46086C4.6025 7.40836 4.66083 7.36751 4.73667 7.33834C4.94667 7.25084 5.20917 7.29752 5.3725 7.46086C5.4775 7.57169 5.54167 7.72335 5.54167 7.87502C5.54167 7.91002 5.53583 7.95086 5.53 7.99169C5.52417 8.02669 5.5125 8.06169 5.495 8.09669C5.48333 8.13169 5.46583 8.16668 5.4425 8.20168C5.425 8.23085 5.39583 8.26001 5.3725 8.28918C5.26167 8.39418 5.11 8.45835 4.95833 8.45835Z"
                    fill="#47586E" />
                  <path
                    d="M7.00001 8.45801C6.92417 8.45801 6.84834 8.44052 6.77834 8.41136C6.7025 8.38219 6.64417 8.34134 6.58584 8.28884C6.48084 8.17801 6.41667 8.03218 6.41667 7.87468C6.41667 7.79885 6.43417 7.72301 6.46334 7.65301C6.49251 7.58301 6.53334 7.51885 6.58584 7.46052C6.64417 7.40802 6.7025 7.36717 6.77834 7.33801C6.98834 7.24467 7.25084 7.29719 7.41417 7.46052C7.51917 7.57135 7.58334 7.72302 7.58334 7.87468C7.58334 7.90968 7.57751 7.95052 7.57167 7.99136C7.56584 8.02636 7.55417 8.06135 7.53667 8.09635C7.525 8.13135 7.50751 8.16635 7.48417 8.20135C7.46667 8.23051 7.4375 8.25968 7.41417 8.28884C7.30334 8.39384 7.15167 8.45801 7.00001 8.45801Z"
                    fill="#47586E" />
                  <path
                    d="M9.04166 8.45801C8.96583 8.45801 8.88999 8.44052 8.81999 8.41136C8.74416 8.38219 8.68583 8.34134 8.6275 8.28884C8.60416 8.25968 8.58083 8.23051 8.55749 8.20135C8.53416 8.16635 8.51666 8.13135 8.505 8.09635C8.4875 8.06135 8.47583 8.02636 8.47 7.99136C8.46416 7.95052 8.45833 7.90968 8.45833 7.87468C8.45833 7.72302 8.5225 7.57135 8.6275 7.46052C8.68583 7.40802 8.74416 7.36717 8.81999 7.33801C9.03583 7.24467 9.29249 7.29719 9.45583 7.46052C9.56083 7.57135 9.625 7.72302 9.625 7.87468C9.625 7.90968 9.61916 7.95052 9.61333 7.99136C9.60749 8.02636 9.59583 8.06135 9.57833 8.09635C9.56666 8.13135 9.54916 8.16635 9.52583 8.20135C9.50833 8.23051 9.47916 8.25968 9.45583 8.28918C9.34499 8.39384 9.19333 8.45835 9.04166 8.45835Z"
                    fill="#47586E" />
                  <path
                    d="M4.95833 10.5002C4.8825 10.5002 4.80667 10.4827 4.73667 10.4535C4.66667 10.4244 4.6025 10.3835 4.54417 10.331C4.43917 10.2202 4.375 10.0685 4.375 9.91686C4.375 9.84102 4.3925 9.76519 4.42167 9.69519C4.45083 9.61935 4.49167 9.5552 4.54417 9.5027C4.76 9.28686 5.15667 9.28686 5.3725 9.5027C5.4775 9.61353 5.54167 9.76519 5.54167 9.91686C5.54167 10.0685 5.4775 10.2202 5.3725 10.331C5.26167 10.436 5.11 10.5002 4.95833 10.5002Z"
                    fill="#47586E" />
                  <path
                    d="M7.00001 10.5002C6.84834 10.5002 6.69667 10.436 6.58584 10.331C6.48084 10.2202 6.41667 10.0685 6.41667 9.91686C6.41667 9.84102 6.43417 9.76519 6.46334 9.69519C6.49251 9.61935 6.53334 9.5552 6.58584 9.5027C6.80167 9.28686 7.19834 9.28686 7.41417 9.5027C7.46667 9.5552 7.5075 9.61935 7.53667 9.69519C7.56584 9.76519 7.58334 9.84102 7.58334 9.91686C7.58334 10.0685 7.51917 10.2202 7.41417 10.331C7.30334 10.436 7.15167 10.5002 7.00001 10.5002Z"
                    fill="#47586E" />
                  <path
                    d="M9.04166 10.5002C8.89 10.5002 8.73833 10.436 8.6275 10.331C8.575 10.2785 8.53416 10.2144 8.505 10.1385C8.47583 10.0685 8.45833 9.99269 8.45833 9.91686C8.45833 9.84103 8.47583 9.76519 8.505 9.69519C8.53416 9.61936 8.575 9.5552 8.6275 9.5027C8.76166 9.36853 8.96583 9.30435 9.15249 9.34519C9.19333 9.35102 9.22833 9.36269 9.26333 9.38019C9.29833 9.39185 9.33333 9.40937 9.36833 9.4327C9.3975 9.4502 9.42666 9.47937 9.45583 9.5027C9.56083 9.61353 9.625 9.76519 9.625 9.91686C9.625 10.0685 9.56083 10.2202 9.45583 10.331C9.34499 10.436 9.19333 10.5002 9.04166 10.5002Z"
                    fill="#47586E" />
                  <path
                    d="M11.9583 5.74023H2.04167C1.80251 5.74023 1.60417 5.5419 1.60417 5.30273C1.60417 5.06357 1.80251 4.86523 2.04167 4.86523H11.9583C12.1975 4.86523 12.3958 5.06357 12.3958 5.30273C12.3958 5.5419 12.1975 5.74023 11.9583 5.74023Z"
                    fill="#47586E" />
                  <path
                    d="M9.33333 13.2712H4.66667C2.5375 13.2712 1.3125 12.0462 1.3125 9.91699V4.95866C1.3125 2.82949 2.5375 1.60449 4.66667 1.60449H9.33333C11.4625 1.60449 12.6875 2.82949 12.6875 4.95866V9.91699C12.6875 12.0462 11.4625 13.2712 9.33333 13.2712ZM4.66667 2.47949C2.99833 2.47949 2.1875 3.29033 2.1875 4.95866V9.91699C2.1875 11.5853 2.99833 12.3962 4.66667 12.3962H9.33333C11.0017 12.3962 11.8125 11.5853 11.8125 9.91699V4.95866C11.8125 3.29033 11.0017 2.47949 9.33333 2.47949H4.66667Z"
                    fill="#47586E" />
                </svg>
              </span>
              <span class="visit-report-card__info-text">
                {{ translate('today') }}
              </span>
            </div>
            }
            }
            @if (!hideStatus) {
            <div [id]="'status-' + (item.id)" class="visit-report-card__status-badge"
              [attr.aria-label]="getStatusName(item.status, item.is_start, item.is_end) + ' status'"
              [ngClass]="getBadgeClass(item.status, item.is_start, item.is_end)">
              <span class="visit-report-card__status-text">
                {{ getStatusName(item.status, item.is_start, item.is_end)  }}
              </span>
            </div>
            }
            @if (isMyType('Upcoming') && !hideStatus) {
            <div [id]="'actions-' + (item.id)" class="visit-report-card__action-dots" aria-label="More actions"
              (click)="$event.stopPropagation()">
              <app-actions-dropdown-menu [menuItems]="chatActionsMenuItems"
                (itemClicked)="handleMenuItemClick($event)" />
            </div>
            }

            @if (isReport) {
            <div [id]="'status-' + (item.id )"
              class="visit-report-card__status-badge visit-report-card__status-badge--report"
              [attr.aria-label]="'reprot status'">
              <span class="visit-report-card__status-text">
                {{ translate('report2') }}
              </span>
            </div>
            }
          </div>
        </div>

        <div class="visit-report-card__description">
          <div class="visit-report-card__features" role="list">
            <div class="visit-report-card__feature-item" role="listitem">
              <span class="visit-report-card__feature-icon" aria-hidden="true" role="img">
                <svg width="14" height="15" viewBox="0 0 14 15" fill="none" xmlns="http://www.w3.org/2000/svg"
                  focusable="false">
                  <path
                    d="M4.08335 6.47819H2.91669C1.50502 6.47819 0.729187 5.70236 0.729187 4.29069V3.12402C0.729187 1.71236 1.50502 0.936523 2.91669 0.936523H4.08335C5.49502 0.936523 6.27085 1.71236 6.27085 3.12402V4.29069C6.27085 5.70236 5.49502 6.47819 4.08335 6.47819ZM2.91669 1.81152C1.99502 1.81152 1.60419 2.20236 1.60419 3.12402V4.29069C1.60419 5.21236 1.99502 5.60319 2.91669 5.60319H4.08335C5.00502 5.60319 5.39585 5.21236 5.39585 4.29069V3.12402C5.39585 2.20236 5.00502 1.81152 4.08335 1.81152H2.91669Z"
                    fill="#47586E" />
                  <path
                    d="M11.0834 6.47819H9.91669C8.50502 6.47819 7.72919 5.70236 7.72919 4.29069V3.12402C7.72919 1.71236 8.50502 0.936523 9.91669 0.936523H11.0834C12.495 0.936523 13.2709 1.71236 13.2709 3.12402V4.29069C13.2709 5.70236 12.495 6.47819 11.0834 6.47819ZM9.91669 1.81152C8.99502 1.81152 8.60419 2.20236 8.60419 3.12402V4.29069C8.60419 5.21236 8.99502 5.60319 9.91669 5.60319H11.0834C12.005 5.60319 12.3959 5.21236 12.3959 4.29069V3.12402C12.3959 2.20236 12.005 1.81152 11.0834 1.81152H9.91669Z"
                    fill="#47586E" />
                  <path
                    d="M11.0834 13.4782H9.91669C8.50502 13.4782 7.72919 12.7024 7.72919 11.2907V10.124C7.72919 8.71236 8.50502 7.93652 9.91669 7.93652H11.0834C12.495 7.93652 13.2709 8.71236 13.2709 10.124V11.2907C13.2709 12.7024 12.495 13.4782 11.0834 13.4782ZM9.91669 8.81152C8.99502 8.81152 8.60419 9.20236 8.60419 10.124V11.2907C8.60419 12.2124 8.99502 12.6032 9.91669 12.6032H11.0834C12.005 12.6032 12.3959 12.2124 12.3959 11.2907V10.124C12.3959 9.20236 12.005 8.81152 11.0834 8.81152H9.91669Z"
                    fill="#47586E" />
                  <path
                    d="M4.08335 13.4782H2.91669C1.50502 13.4782 0.729187 12.7024 0.729187 11.2907V10.124C0.729187 8.71236 1.50502 7.93652 2.91669 7.93652H4.08335C5.49502 7.93652 6.27085 8.71236 6.27085 10.124V11.2907C6.27085 12.7024 5.49502 13.4782 4.08335 13.4782ZM2.91669 8.81152C1.99502 8.81152 1.60419 9.20236 1.60419 10.124V11.2907C1.60419 12.2124 1.99502 12.6032 2.91669 12.6032H4.08335C5.00502 12.6032 5.39585 12.2124 5.39585 11.2907V10.124C5.39585 9.20236 5.00502 8.81152 4.08335 8.81152H2.91669Z"
                    fill="#47586E" />
                </svg>
              </span>
              <p class="visit-report-card__feature-text">
                @if (item.doctor?.specialties?.length) {
                {{ item.doctor?.specialties?.[0]?.name }}
                } @else {
                {{ translate('no_specialty') }}
                }
              </p>
            </div>

            <div class="visit-report-card__feature-item" role="listitem">
              <span class="visit-report-card__feature-icon" aria-hidden="true" role="img">
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="15" viewBox="0 0 14 15" fill="none">
                  <path
                    d="M6.99997 13.701C6.60914 13.701 6.21247 13.6135 5.90331 13.4326L2.69497 11.5835C1.38831 10.7026 1.30664 10.5685 1.30664 9.18596V5.8143C1.30664 4.4318 1.38247 4.29763 2.66581 3.42846L5.89747 1.5618C6.50997 1.20596 7.47247 1.20596 8.08497 1.5618L11.305 3.4168C12.6116 4.29763 12.6933 4.4318 12.6933 5.8143V9.18013C12.6933 10.5626 12.6175 10.6968 11.3341 11.566L8.10247 13.4326C7.78747 13.6135 7.39081 13.701 6.99997 13.701ZM6.99997 2.1743C6.75497 2.1743 6.51581 2.22096 6.34664 2.32013L3.13831 4.17513C2.18747 4.8168 2.18747 4.8168 2.18747 5.8143V9.18013C2.18747 10.1776 2.18747 10.1776 3.16164 10.8368L6.34664 12.6743C6.69081 12.8726 7.31497 12.8726 7.65914 12.6743L10.8675 10.8193C11.8125 10.1776 11.8125 10.1776 11.8125 9.18013V5.8143C11.8125 4.8168 11.8125 4.8168 10.8383 4.15763L7.65331 2.32013C7.48414 2.22096 7.24497 2.1743 6.99997 2.1743Z"
                    fill="#47586E" />
                  <path
                    d="M7 9.6875C5.7925 9.6875 4.8125 8.7075 4.8125 7.5C4.8125 6.2925 5.7925 5.3125 7 5.3125C8.2075 5.3125 9.1875 6.2925 9.1875 7.5C9.1875 8.7075 8.2075 9.6875 7 9.6875ZM7 6.1875C6.27667 6.1875 5.6875 6.77667 5.6875 7.5C5.6875 8.22333 6.27667 8.8125 7 8.8125C7.72333 8.8125 8.3125 8.22333 8.3125 7.5C8.3125 6.77667 7.72333 6.1875 7 6.1875Z"
                    fill="#47586E" />
                </svg>
              </span>
              <p class="visit-report-card__feature-text">
                {{item.original_type}}
              </p>
            </div>

            @if (type === cardTypes.FIRE) {
            <div class="visit-report-card__info-item" role="listitem">
              <span class="visit-report-card__info-icon" aria-hidden="true" role="img">
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14" fill="none"
                  focusable="false">
                  <path
                    d="M6.99996 13.2712C3.54079 13.2712 0.729126 10.4595 0.729126 7.00033C0.729126 3.54116 3.54079 0.729492 6.99996 0.729492C10.4591 0.729492 13.2708 3.54116 13.2708 7.00033C13.2708 10.4595 10.4591 13.2712 6.99996 13.2712ZM6.99996 1.60449C4.02496 1.60449 1.60413 4.02533 1.60413 7.00033C1.60413 9.97533 4.02496 12.3962 6.99996 12.3962C9.97496 12.3962 12.3958 9.97533 12.3958 7.00033C12.3958 4.02533 9.97496 1.60449 6.99996 1.60449Z"
                    fill="#47586E" />
                  <path
                    d="M9.16421 9.29253C9.08837 9.29253 9.01254 9.27503 8.94254 9.22836L7.13421 8.14919C6.68504 7.88086 6.35254 7.29169 6.35254 6.77253V4.38086C6.35254 4.14169 6.55087 3.94336 6.79004 3.94336C7.02921 3.94336 7.22754 4.14169 7.22754 4.38086V6.77253C7.22754 6.98253 7.40254 7.29169 7.58337 7.39669L9.39171 8.47586C9.60171 8.59836 9.66587 8.86669 9.54337 9.07669C9.45587 9.21669 9.31004 9.29253 9.16421 9.29253Z"
                    fill="#47586E" />
                </svg>
              </span>
              <p class="visit-report-card__info-text">
                <time [attr.datetime]="item.date + 'T' + item.start_time">
                  {{ getFormattedDate(item.date, item.start_time, 'h:mm:ss a') }}
                </time>
                -
                <time [attr.datetime]="item.date + 'T' + item.end_time">
                  {{ getFormattedDate(item.date, item.end_time, 'h:mm:ss a') }}
                </time>
              </p>
            </div>
            }
          </div>
        </div>


        @if (type !== cardTypes.FIRE && !hideBottomBarDetails) {
        <div class="visit-report-card__info-group">
          <div class="visit-report-card__info-item">
            <p class="visit-report-card__info-text">
              <time [attr.datetime]="item.date">
                {{ getFormattedDate(item.date, null, 'EEEE - d MMMM') }}
              </time>
            </p>
          </div>
          <div class="visit-report-card__info-item">
            <span class="visit-report-card__info-icon" aria-hidden="true" role="img">
              <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14" fill="none"
                focusable="false">
                <path
                  d="M6.99996 13.2712C3.54079 13.2712 0.729126 10.4595 0.729126 7.00033C0.729126 3.54116 3.54079 0.729492 6.99996 0.729492C10.4591 0.729492 13.2708 3.54116 13.2708 7.00033C13.2708 10.4595 10.4591 13.2712 6.99996 13.2712ZM6.99996 1.60449C4.02496 1.60449 1.60413 4.02533 1.60413 7.00033C1.60413 9.97533 4.02496 12.3962 6.99996 12.3962C9.97496 12.3962 12.3958 9.97533 12.3958 7.00033C12.3958 4.02533 9.97496 1.60449 6.99996 1.60449Z"
                  fill="#47586E" />
                <path
                  d="M9.16421 9.29253C9.08837 9.29253 9.01254 9.27503 8.94254 9.22836L7.13421 8.14919C6.68504 7.88086 6.35254 7.29169 6.35254 6.77253V4.38086C6.35254 4.14169 6.55087 3.94336 6.79004 3.94336C7.02921 3.94336 7.22754 4.14169 7.22754 4.38086V6.77253C7.22754 6.98253 7.40254 7.29169 7.58337 7.39669L9.39171 8.47586C9.60171 8.59836 9.66587 8.86669 9.54337 9.07669C9.45587 9.21669 9.31004 9.29253 9.16421 9.29253Z"
                  fill="#47586E" />
              </svg>
            </span>
            <p class="visit-report-card__info-text">
              <time [attr.datetime]="item.date + 'T' + item.start_time">
                {{ getFormattedDate(item.date, item.start_time, 'h:mm:ss a') }}
              </time>
              -
              <time [attr.datetime]="item.date + 'T' + item.end_time">
                {{ getFormattedDate(item.date, item.end_time, 'h:mm:ss a') }}
              </time>
            </p>
          </div>
        </div>
        }
      </div>
    </div>
  </div>
</article>
