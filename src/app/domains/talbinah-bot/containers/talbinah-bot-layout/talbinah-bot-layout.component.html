@if (isBrowser) {
<main class="chat-layout" role="main">
  <header class="chat-layout__header">
    <app-site-header></app-site-header>
  </header>
  <section class="chat-layout__container" #card>
    <div [attr.aria-label]="headerConfig.title + ' header'">
      <app-page-layout-header [config]="headerConfig" [card]="cardRef" [disablePadding]="true"
        (closeRequested)="goHome()"></app-page-layout-header>
    </div>

    <div class="chat-layout__cards" appAutoExactHeight [enabled]="!isFullscreen" role="region"
      aria-label="Chat and appointments">
      <div class="chat-layout__main-content">
        @if (isLoadingHistory()) {
        <div class="shimmer-container">
          <header class="chat-messages__header shimmer-wrapper" style="height: 3.5rem; width: 100%;">
            <div class="chat-messages__header__title">
              <div class="label shimmer-text-line shimmer-text-line--short" style="width: 100px;"></div>
              <div class="icon shimmer-icon" style="width: 18px; height: 18px; background-color: #edeef1;"></div>
            </div>
            <button class="chat-messages__header__new-chat shimmer-wrapper"
              style="width: 80px; height: 32px; border-radius: 0.75rem; background-color: #edeef1;"></button>
          </header>
          <ul class="shimmer-list">
            @for (tab of [1,2]; track $index) {
            <li class="shimmer-message shimmer-message--user">
              <div class="shimmer-icon shimmer-wrapper"></div>
              <div class="shimmer-content-wrapper" style="flex:1">
                <div class="shimmer-content shimmer-wrapper">
                  <div class="shimmer-text-line shimmer-text-line--long"></div>
                  <div class="shimmer-text-line shimmer-text-line--short"></div>
                </div>
                <div class="shimmer-timestamp shimmer-wrapper"></div>
              </div>
            </li>

            <li class="shimmer-message shimmer-message--bot">
              <div class="shimmer-icon shimmer-wrapper"></div>
              <div class="shimmer-content-wrapper" style="flex: 1;">
                <div class="shimmer-content shimmer-wrapper" style="width: 85%;">
                  <div class="shimmer-text-line shimmer-text-line--long"></div>
                  <div class="shimmer-text-line shimmer-text-line--long"></div>
                  <div class="shimmer-text-line shimmer-text-line--short"></div>
                </div>
                <div class="shimmer-timestamp shimmer-wrapper"></div>
              </div>
            </li>
            }
          </ul>
        </div>
        }@else {
        <app-chat-messages [chatSelectedItem]="chatSelectedItem"></app-chat-messages>
        @if(chatSelectedItem()){
        <div class="chat-layout__send-ction">
          <app-chat-input class="chat-input"></app-chat-input>
        </div>
        }
        }
      </div>
      <aside class="chat-layout__grids-list" role="complementary">
        <!-- <div class="chat-layout__grids-list-card">
          <app-mental-state />
        </div> -->
        <div class="chat-layout__grids-list-card">
          <app-talbinah-bot-records (chatSelected)="onChatSelected($event)" />
        </div>
      </aside>
    </div>
  </section>
</main>
}